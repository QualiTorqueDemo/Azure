spec_version: 2
description: >
  Deploy a multiple node pools Kubernetes cluster on AKS with 
  monitoring support through Azure Log Analytics. Includes 3 worker 
  node pools with configurable Kubernetes version.

inputs:
  agent:
    type: string
    description: "Select the Torque agent to deploy this environment"
    default: '{{ .params.default_aks_host }}'
    allowed-values:
      - aks-prod
      - aks-dev-temp
  Azure Region:
    type: string
    description: "Azure region for deployment"
    default: "westus2"
    allowed-values:
      - northcentralus
      - swedencentral
      - francecentral
      - northeurope
      - westus
      - westus2

outputs: {}

grains:
  multi-nodepool-aks:
    kind: terraform
    spec:
      source:
        store: Azure
        path: assets/multi-nodepool-aks
      agent:
        name: '{{ .inputs.agent }}'
      inputs:
        - location: '{{ .inputs.["Azure Region"] }}'
